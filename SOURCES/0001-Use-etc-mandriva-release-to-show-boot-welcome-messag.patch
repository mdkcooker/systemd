(blino) adapted from below

From 33f534bd3451bb5229cab976ea4277b6da0843bc Mon Sep 17 00:00:00 2001
From: Andrey Borzenkov <arvidjaar@gmail.com>
Date: Fri, 3 Dec 2010 09:53:08 +0300
Subject: [PATCH] Use /etc/mandriva-release to show boot welcome message

And use correct colors
---
 src/util.c |   43 ++++++++++++++++++++++++-------------------
 1 files changed, 24 insertions(+), 19 deletions(-)

diff --git a/src/util.c b/src/util.c
index 0cd78f6..939da5c 100644
--- a/src/util.c
+++ b/src/util.c
@@ -2996,25 +2996,30 @@ void status_welcome(void) {
         }
 
 #if defined(TARGET_FEDORA)
-        if (!pretty_name) {
-                if ((r = read_one_line_file("/etc/system-release", &pretty_name)) < 0) {
-
-                        if (r != -ENOENT)
-                                log_warning("Failed to read /etc/system-release: %s", strerror(-r));
-                } else
-                        truncate_nl(pretty_name);
-        }
-
-        if (!ansi_color && pretty_name) {
-
-                /* This tries to mimic the color magic the old Red Hat sysinit
-                 * script did. */
-
-                if (startswith(pretty_name, "Red Hat"))
-                        const_color = "0;31"; /* Red for RHEL */
-                else if (startswith(pretty_name, "Fedora"))
-                        const_color = "0;34"; /* Blue for Fedora */
-        }
+	if (!pretty_name) {
+		char *r, *v = NULL, *p;
+
+		if (read_one_line_file("/etc/release", &r) < 0)
+			return;
+
+		p = strstr(r, " release ");
+		if (!p) {
+			free(r);
+			return;
+		}
+
+		*p = '\0';
+		v = p += 9;
+		while (*p && *p != ' ')
+			p++;
+		*p = '\0';
+
+		/* This corresponds to standard rc.sysinit */
+		status_printf("\t\t\tWelcome to \x1B[1;36m%s\x1B[0;39m %s\x1B[0m\n", r, v);
+
+		free(r);
+		return;
+	}
 
 #elif defined(TARGET_SUSE)
 
-- 
1.7.3.2

