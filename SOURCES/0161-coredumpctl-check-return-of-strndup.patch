From 3933cd6c29becca0c7ddc725ffdf0cd1afb652d5 Mon Sep 17 00:00:00 2001
From: Lukas Nykryn <lnykryn@redhat.com>
Date: Wed, 19 Dec 2012 14:38:53 +0100
Subject: [PATCH 161/204] coredumpctl: check return of strndup (cherry picked
 from commit 348a25edbb87ee4e67aa79fcb97a2bc1b5c11c7b)

Conflicts:
	src/journal/coredumpctl.c
---
 src/journal/coredumpctl.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/src/journal/coredumpctl.c b/src/journal/coredumpctl.c
index 5c442ff..db6306f 100644
--- a/src/journal/coredumpctl.c
+++ b/src/journal/coredumpctl.c
@@ -222,7 +222,7 @@ static int retrieve(sd_journal *j, const char *name, const char **var) {
         assert(len >= field);
 
         *var = strndup((const char*)data + field, len - field);
-        if (!var)
+        if (!*var)
                 return log_oom();
 
         return 0;
-- 
1.8.1.5

